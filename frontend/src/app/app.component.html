<div class="app-root">
  <aside class="sidebar">

    <div class="classroom">
      <div class="logo">
        <!--<img src="../assets/logoCCcut.png" alt="ConnectClass Logo" class="logo-img">-->
        <h1>Connect<span class="logo-accent">Class</span></h1>
      </div>

      <div class="mini-calendar-container">
        <sx-calendar class="mini-calendar" [calendarApp]="miniCalendar"></sx-calendar>
      </div>

      <label class="room-label">Sala de Aula</label>
<select class="room-select"
  aria-label="Selecionar turma"
  [(ngModel)]="selectedRoomCode"  
  (change)="onRoomChange()">

  <option *ngFor="let room of rooms" [value]="room.code"> 
    {{ room.label }}
  </option>

</select>


    </div>

    <div class="tasks-section">
      <h4>Tarefas</h4>

      <label class="task-filter">
        <input type="checkbox" [checked]="filters.other" (change)="toggleFilter('other')">
        <span class="task-indicator other"></span>
        Outras tarefas
      </label>

      <label class="task-filter">
        <input type="checkbox" [checked]="filters.basic" (change)="toggleFilter('basic')">
        <span class="task-indicator basic"></span>
        Básico
      </label>

      <label class="task-filter">
        <input type="checkbox" [checked]="filters.relative" (change)="toggleFilter('relative')">
        <span class="task-indicator relative"></span>
        Relativa
      </label>

      <label class="task-filter">
        <input type="checkbox" [checked]="filters.important" (change)="toggleFilter('important')">
        <span class="task-indicator important"></span>
        Importante
      </label>
    </div>

  </aside>

  <main>

    <section class="tasks-viewer">
      <div class="tasks-header">
        <div class="tabs">
          <button class="tab active">Hoje</button>
          <button class="tab">Semana</button>
        </div>

        <button class="create-task-btn" (click)="openTaskModal()">
          Nova Tarefa
        </button>
      </div>

      <div class="tasks-content">
        <div *ngIf="tasks.length === 0" class="no-tasks">Nenhuma tarefa criada</div>

        <div class="task-item" *ngFor="let task of tasks" (click)="openTaskModal(task)">
          <div class="task-info">
            <strong>{{ task.title }}</strong>
            <span class="task-time">
  {{ task.start | date:'dd/MM HH:mm' }} — {{ task.end | date:'dd/MM HH:mm' }}
</span>
          </div>
          <span class="priority" [ngClass]="task.difficulty"></span>
        </div>
      </div>
    </section>

    <section class="calendar-area">
      <sx-calendar class="ng-calendar-wrapper" [calendarApp]="calendarApp">
        <ng-template #timeGridEvent let-arg>
          <div class="event-template"
               [ngStyle]="{
                 'background-color': arg.calendarEvent.color,
                 'border-color': arg.calendarEvent.color,
                 'color': getEventTextColor(arg.calendarEvent.difficulty),
                 'border': '2px solid ' + getEventTextColor(arg.calendarEvent.difficulty),
                 'font-weight': '600'
               }">
            <div class="event-title">{{ arg.calendarEvent.title }}</div>
          </div>
        </ng-template>
      </sx-calendar>
    </section>

  </main>
</div>

<div class="task-modal-backdrop" *ngIf="taskModalOpen" (click)="closeTaskModal()">
  <div class="task-modal" (click)="$event.stopPropagation()">
    <div class="task-modal-header">
      <h3>{{ editingTask ? 'Editar Tarefa' : 'Nova Tarefa' }}</h3>
      <button class="close-btn" (click)="closeTaskModal()">✕</button>
    </div>

    <div class="task-modal-body">
      <input type="text" placeholder="Título" [(ngModel)]="taskForm.title" />

      <textarea type="text" [(ngModel)]="taskForm.description"></textarea>


      <div class="datetime-row">
        <input type="datetime-local" [(ngModel)]="taskForm.start" />
        <input type="datetime-local" [(ngModel)]="taskForm.end" />
      </div>

      <div class="select-row">
        <label>
          Prioridade
          <select [(ngModel)]="taskForm.difficulty">
            <option value="basic">Básico</option>
            <option value="relative">Relativa</option>
            <option value="important">Importante</option>
            <option value="other">Outras</option>
          </select>
        </label>
      </div>
    </div>

    <div class="task-modal-actions">
      <button class="btn btn-cancel" (click)="closeTaskModal()">Cancelar</button>
      <button *ngIf="editingTask" class="btn btn-delete" (click)="deleteTask(taskForm.id)">Excluir</button>
      <button class="btn btn-save" (click)="saveTask()">Salvar</button>
    </div>
  </div>
</div>

<router-outlet></router-outlet>
